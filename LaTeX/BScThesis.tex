\documentclass[a4paper,12pt]{report}
\usepackage{amsmath}
\usepackage[]{graphicx}
\usepackage[utf8]{inputenc}
\usepackage{amssymb}
\usepackage{color}
\usepackage{CogSciBScUOS}
\usepackage{indentfirst}


\title{Automatic Prediction of Harmonic Rhythm from Melodies}
\author{Valentin Huemerlehner}
\email{vhuemerlehne@uni-osnabrueck.de}
\firstSupervisor{Prof. Dr. Kai-Uwe KÃ¼hnberger}
\secondSupervisor{PhD Maximos Kaliakatsos-Papakostas}


\begin{document}

\beforepreface %needed clause, generates e.g. title page

\prefacesection{Abstract}
In this thesis, I tried to extract the harmonic rhythm from a given melody. Alongside the melody, information on cadence placement and the bar boundaries are given. The system learned style-specific patterns from an annotated corpus of pieces in different styles, with the same information as above and additionally the original harmonisation in a reduction of medium depth. With this, I wanted to answer the question whether or not it may be possible to define one of the two elements necessary for a harmonisation (the harmonies and their locations) independently of the other. Achieving this would mean a step forward towards an autonomous harmonisation tool that is most importantly independent of its user's expert knowledge. Thus, such a system could also be used by musical beginners or even musically inept users.

\prefacesection{Acknowledgements}


\afterpreface %needed clause, generates e.g. table of contents
\newpage

%\listoffigures
%\newpage

\pagenumbering{arabic}

%use   \newsection{XYZ}

%instead of the "\section" command!

\chapter{Existing work on the topic}
In the last years, scientific progress on computational creativity has accelerated more and more in all aspects of creativity. In the fine arts, this progress is mainly driven by neural networks, allowing for new techniques such as style overlaying or style blending and recombination of different aspects of an image (such as form and texture) \emph{\colorbox{red}{[CITATION NEEDED]}}. In music, neural networks are also beginning to make their mark, one example being "DeepBach", a neural network able to copy Bach's chorale style (or any other, provided the correct input) and already fooling even musical experts from time to time\footnote{\cite{hadjeres2016deepbach}}.
Examples for systems: Flow Machines (Sony France), Watson Beat (IBM), Jukedeck (London Startup), CHAMELEON, Songsmith (Google), Magenta (Google)


\chapter{Musictheoretical background}
\section{General Western music theory}


\section{Harmonic rhythm}
When thinking about harmonic rhythm, I ran into the problem of a lacking common definition in the literature. Therefore, I will give a historical overview on the topic.

\subsection{First formal definition by Walter Piston}
\subsubsection{Harmonic rhythm in practice}
For the longest time, harmonic rhythm was a concept that was only roughly outlined, yet left untouched in terms of a precise definition. Jean Philippe Rameau -- the first Western composer to properly write down some of the existing concepts of "good" compisition practices -- only states that one should not change harmony on the weak beats of a bar.\footnote{\cite{rameau1722traite}, book 3, chapter 40, p.317f.} This concept was agreed upon quite commonly, showing that in practice, composers were well aware of the effect that harmonic changes, meter and their interaction had.
\subsubsection{Definition as root changes}
Yet, it was not until 1944 that Walter Piston tried to give a more formal definition of harmonic rhythm in the first edition of the Harvard Dictionary of Music:
\begin{quote}
Harmonic rhythm. The rhythmic life contributed to music by means of the underlying changes of harmony. The pattern of the harmonic rhythm of a given piece of music, derived by noting the root changes as they occur, reveals important and distinctive features affecting the style and texture.\footnote{\cite{willi1944harvard}, as cited in \cite{swain2002harmonic}, p.6}
\end{quote}
He elaborates on this definition in his book "Harmony".\footnote{\cite{piston1978harmony}, read in the 4\textsuperscript{th} edition edited by Mark DeVoto, 1978} In this volume, he strongly presupposes a Western tonality in the sense of a Roman numeral analysis of harmonies. Using a harmonic analysis of a given piece, he then defines root changes as the rhythmic events that make up harmonic rhythm.\footnote{[ibid.], p.190f.} Thus, melodic and harmonic rhythm may, but do not necessarily have to coincide (a possible example of parallel harmonic and melodic rhythms are homophonic passages, where all voices or instruments progress melodically at the same time, often leading to harmonic progression).\footnote{[ibid.], p.191ff.}

\subsubsection{Frequency of root change}
A perceptually highly salient aspect of harmonic rhythm is the general speed of harmonic movement.\footnote{[ibid.], p.193ff.} As can be seen in the two examples, the range of possible tempi is large. Even the complete lack of harmonic changes may be applied to great effect, although in many cases, such a missing sense of movement is perceived as bland. A special case of a static harmonic rhythm can be a bass pedal -- i.e. a single note that is held or repeated over a prolonged period of time, to some degree independent of the other voices' development -- that ''[...] tends to overpower the sense of harmonic progression[...]''.\footnote{[ibid.], p.196} Hence, even though movement may be present harmonically, it is perceptually omitted by the stronger effect of the pedal.

\subsubsection{Strength of harmonic progressions}
As one might expect -- and for the purpose of this work quite unfortunately -- the perceptual importance of harmonic changes is not independent of their content, i.e. the actual change applied.\footnote{\cite{rameau1722traite}, book 3, chapter 40, p.315f. and \cite{piston1978harmony}, p.196f.} A prime example for an especially salient progression -- at least in western music -- are cadences that provide closure after a point of maximal tension.\footnote{For theoretical insights, see -- among many others -- \cite{jackendoff1983generative}, for experimental evidence, see \cite{bigand1999perceiving}.} As already seen in Rameau's treatise, the rhythm and timing of these progressions used to be highly regulated. While such rules weakened and to a certain degree disappeared in the late 19\textsuperscript{th} and beginning 20\textsuperscript{th} century,\footnote{For rather conservative views on harmonic rules, see \cite{riemann1893vereinfachte} and \cite{schenker1906harmonielehre}. For the highly progressive view of Arnold Sch\"onberg, albeit before development of his twelve-tone theory, see \cite{schonberg1922harmonielehre} and for an example of complete deletion of harmonic considerations, see \cite{schonberg1976stil}.}, they might still give an important hint towards the positioning of harmonic changes, justifying a trial to find most likely beats for harmonic changes within a meter.

\subsubsection{Dynamic indications}
According to Piston, the harmonic rhythm and its valence may also be influenced by dynamic indications made by the composer to clearly indicate their intentions, possibly overriding the interpreter's musical intuitions.\footnote{\cite{piston1978harmony}, p.198f.} However, since this phenomenon of contradicting information from musical intuition and compositional indications is somewhat rare, I did not include it in my analyses.

\subsubsection{Nonharmonic chords}
Lastly, Piston also postulated the existence of nonharmonic chords, similarly to nonharmonic notes. Nonharmonic chords are those that, despite presenting a root change and thus some harmonic movement, are not processed as such by the listener.\footnote{[ibid.], p.201} This mostly occurs in fast passages where movement is abundant and is facilitated by the chords not being presented in root position, thus omitting the root note and hindering recognition of the chord. This again is an infrequent phenomenon, which I left out in my analysis. It is however a candidate for future expansion.

\subsection{Enhancements of Piston's work}
\subsubsection{Problems about the root change approach}
The main problem about Walter Piston's approach to harmonic rhythm is that an analysis in form of Roman numerals needs to exist. This actually entails two separate problems: On the one hand, such an analysis has to be possible in the first place, i.e. the music needs to be tonal for it to properly work. This is not the case for all music predating the renaissance, for quite a range of music (Twelve-tone Music, Experimental Music, Rock, Metal, etc.) starting from the 20\textsuperscript{th} century and most music that does not stem from the European tradition. On the other hand, analyses of this kind do not always follow strict rules, but involve the analyser's interpretation of certain ambivalent occurences (e.g. an underdefined harmony, where only two notes of a triad are played and thus, multiple triads could fit). One example where this was criticised, but not circumvented, is the article "Harmonic Rhythm in Beethoven's symphonies" by Jan LaRue \footnote{\cite{la2001harmonic}}. The other details of the article are of no interest to this thesis (although quite interesting from a musicological point of view).

\subsubsection{A solution proposed by Joseph Swain}
This exact problem of ambiguity is tackled in Joseph Swain's book by the telling title of ''Harmonic Rhythm - Analysis and Interpretation''. Swain sees himself in Piston's tradition and thinks of his work as a mere consequence: \begin{quote}There is no reason to think that Walter Piston would disapprove of such hierarchical pictures. They are logical extensions of his original insight.\footnote{\cite{swain2002harmonic}, p.57}\end{quote} He introduces a hierarchical system of analysis levels that form around Piston's central idea of root changes in a moderate -- i.e. processable -- speed. I will introduce the different levels of analysis under the point of view of utility and feasability in the following.

\subsubsection{Rhythm of the texture}
Swain's first level of analysis is the rhythm of the texture. It is produced by simply adding up all rhythmical events into a single line, thus denoting all rhythmical events the listener could possibly perceive.\footnote{[ibid.], p.15ff.} This means that at any harmonical rhythmic event -- no matter the exact definition -- needs to necessarily correspond to a textural rhythmic event.\footnote{[ibid.], p.17} However, there are easily imaginable examples for textural rhythmic events that can not be counted as harmonic rhythm since no change in pitches occurs (such as repeated chords, as found in the beginning of the ''Waldstein'' sonata by Ludwig van Beethoven, op.53). \emph{\colorbox{red}{add example?}} Hence, I did not include textural rhythm in my analysis.

\subsubsection{Phenomenal harmonic rhythm}
The next dimension is called the phenomenal harmonic rhythm. It denotes all time points at which the chord changes in any way, including new harmonies as well as inversions of chords. Quite often, textural and phenomenal harmonic rhythm may be the same, but a prominent example of the opposite can be seen in the beginning of Antonio Vivaldi's fourth concerto of the so called "Four Seasons" (op. 8, no. 4, "Winter", I): \emph{\colorbox{red}{ADD EXAMPLE FROM SWAIN, 32}}
Swain further differentiates between this texture phenomenal harmonic rhythm and what he calls contrapuntal phenomenal harmonic rhytm. The latter he defines as follows: "the changes in harmonic phenomena caused by moving voices."\footnote{[ibid.], p.28} The concept is easiest to understand by virtue of an example: \emph{\colorbox{red}{ADD EXAMPLE FROM SWAIN, 34 OR OWN SHEETS}} In Fr\'{e}d\'{e}ric Chopin's \'{E}tude op. 25, no. 1 for piano, bass and melody are played in the respective outside fingers of each hand while the other fingers contribute the harmonies in the form of rapid arpeggios. These do count into the textural phenomenal harmonic rhythm, but are not a separate voice in Swain's definition, thus not being included in the contrapuntal version. The differentiation therefore seems to be one of perceptual relevance: The middle parts are not perceived as melodic events due to their high speed and dynamical softness and therefore are not part of the counterpoint.

To check for the importance of phenomenal harmonic rhythm for the purpose of this thesis, I will take a look at Swain's reasoning: According to him, a comparison between textural and phenomenal rhythm can already provide first insights into the emotional valence of a passage, which however is of no further interest in my case. More interestingly, he sees this level of analysis as the only one to remain free of an evaluation of harmonic events:\footnote{[ibid.], p.23} Since every (perceived) change in pitches is denoted, the content of the change is not important, but the two harmonic events before and after the change can be compared neutrally. This makes this level of analysis interesting for non-tonal (ancient and modern) as well as non-Western music. In the corpus of pieces used for this thesis, only tonal and Western music was used, which makes this level obsolete, but for a more general solution to the problem, its inclusion may be necessary.

\subsubsection{Bass pitch harmonic rhythm}
On the next level, Swain examines the changes in the bass voice. Notably, the bass voice need not necessarily always be the lowest voice. Part-crossings due to voice-leading considerations and timbre may lead to the lowest note not being perceived as the bass.\footnote{[ibid.], p.36ff.} Since the bass may move in octaves, therefore not changing its pitch class, the bass pitch harmonic rhythm can be faster than the Pistonian root change rhythm.\footnote{[ibid.], p.31\&33} Of course, this may also happen in reverse, when the bass note is not changed, yet harmonically reinterpreted as a new function within the chord.\footnote{In non-equal temperaments (which can be found almost everywhere as soon as no keyboard instruments are involved), one could argue that the bass note does change upon enharmonic reinterpretation. However, such a microtonal change is not represented in the score and will only be perceived by a small number of highly trained listeners. See \cite{szende1977intervallic} for experimental evidence on intervallic intonation hearing in music professionals.} Since the bass is perceptually quite prominent, this seems like an interesting candidate for extraction of regularities that may also be found in the melody. However, most of the bass pitch rhythm is covered by the root changes anyways, diminishing the expected gains significantly. Again, this dimension may be a candidate for future extension, but did not find consideration in my current thesis.

\subsubsection{Root/Quality harmonic rhythm}
In the fourth dimension of harmonic rhythm, Swain finally returns to Piston's definition of harmonic rhythm as the rhythm of root changes. He does apply two important adaptations though:

Firstly, he does not use a Roman numeral analysis as the basis of finding root changes, but instead looks directly at the absolute chord symbols, as can be seen in the following example: \emph{\colorbox{red}{ADD EXAMPLE SWAIN ??}} Thereby, he tries to eliminate the subjectiveness of the analysis that needs to be made before usage of the functional chord numerals. Also, it allows for a slightly more precise analysis as Roman numerals \emph{\colorbox{red}{WTF?! Why? READ AGAIN!}} The functional information will be used in the last level of analysis so that no information is lost.

Secondly, Swain introduces a hierarchical system: On the lowest level, all root changes are denoted. On higher levels, brief chords that may be seen as contrapuntal coincidences instead of actual chords, may be omitted and subsumed under a perceptually more important primary chord.\footnote{This idea seems strongly influenced by the Schenkerian idea of hierarchical music analysis, originally put forth by Heinrich Schenker 1906-1935 \cite{schenker1906harmonielehre}, \cite{schenker1991neue} and \cite{schenker1956freie}, and expanded in \cite{jackendoff1983generative}\textcolor{red}{, also basis for the current efforts of Prof. Dr. Martin Rohrmeier at the TU Dresden} \emph{\colorbox{red}{CITATION NEEDED}}} Obviously, this type of hierarchical analysis involves a considerable amount of interpretation -- e.g. how many levels to use, how detailed each of these levels should -- reintroducing some of the ambiguity eliminated by using absolute chord symbols instead of Roman numerals. Swain puts forth a number of rules to minimise this ambiguity that I will not further explain here, but may be of interest to the musicologically more inclined reader.\footnote{\cite{swain2002harmonic}, p. 44ff.}

The dimension of root changes or "Quality harmonic rhythm" seems quite suited for the purpose of this thesis: Its independence from tonal systems and subjective opinions by the analyser open the possibility for broad usage in a range of styles while allowing for post-hoc functional analysis, although limited in detail.

\subsubsection{Density of harmonic rhythm}
On another (though not necessarily more complex) level, Swain considers the chords' density and thus, the strength of the harmonic progression. The density of a progression is defined by the number of voices that change their sounding note into one that is part of the new harmony.\footnote{[ibid.], p.58} While a singular density may not be of high perceptual importance, a passage with high density values will tend to appear more powerful than one with very low density changes, even if they are of the same dynamic force.\footnote{[ibid.], p.60} Again, Swain goes into more detail of the interpretational possibilities and challenges (such as two voices leading into the same note or even the question how to define a voice e.g. in a piano score), that I will not cover here, but may be useful for a deeper understanding.\footnote{[ibid.], p.63ff.}

\subsubsection{Rhythm of harmonic functions}
In the last dimension of his analysis, Swain reintroduces the functional analysis of a piece. While the original idea of Piston used it, the root level probably describes his intentions better. As does Piston, Swain allows for embedding of short phrases that are not long or significant enough to be called an entire modulation.\footnote{[ibid.], p.70ff.} Swain however only uses three symbols (I, IV and V for tonic, subdominant and dominant) since these three basic functions should suffice in his opinion.\footnote{[ibid.], p.69} Thus, he has to use embedding more often than Piston.

\subsubsection{Consequences}
Having seen the two most important works on the topic, it is now time to draw conclusions for the approach of this thesis. While the corpus that I worked with, was already finished and the analyses of the pieces had already been made, it is still necessary to check for their validity in respect to harmonic rhythm.

The reductions given to me were on a somewhat inconsistent, but mostly intermediate level of detail. Those pieces that differed from the average detailedness tended to be of slightly higher precision. From them, analyses were generated by the GCT algorithm, also in work prior to this thesis. The thusly generated chord sequences are, speaking in terms of Swain, of the root change type. As mentioned in the sections above, I consider this level to be a reasonable one for two reasons:

It provides a reasonable tradeoff between feasability and information content as it can be relatively easily generated computationally (as opposed to the highly subjective functional analysis). Other than e.g. the bass movement harmonic rhythm that can contain imprecisions, it yields all of the harmonic information, though not necessarily in an accesible form (i.e. it tracks all harmonic changes, but does not interpret them in a meaningful way).

At the same time, it is usable in non-tonal systems, allowing for a wide range of musical styles to be put into the system. Due to the assumptions made for further analytical steps, I expect a performance bias towards tonal music, because I know best about it and its rules of harmony and harmonic rhythm.

\section{Aspects of melodies with possible correlations to harmonic rhythm}
In the following section, I will describe the thought process behind the decisions made for some aspects in melodies and my hopes for them being predictors for harmonic rhythm.

\subsubsection{Communicative pressure}
In his book ``Music and Probability"\footnote{\cite{temperley2007music}}, Temperley puts forth his earlier formulated idea of communicative pressure\footnote{\cite{temperley2004communicative}}, and uses different examples to show his idea: since music has the goal of communicating between composer/interpreter and listener, a common ground of this communication, some kind of ruleset, needs to be set so that the listener has any chance to understand the composer's intentions. This includes style-specific amounts of syncopation and rubato to be used. Temperley notes that styles with high syncopation tend to be very strict in the tempo used and vice versa. This supports the idea that concurring factors of complexity in music may be negatively correlated. Thus, it seems reasonable to assume that this might also apply to harmonic rhythm and some other feature (e.g. melodic rhythm) in terms of speed and complexity. As it is very hard to properly define ``complexity'' of a melody, I instead used syncopation as an indicator of rhythmic complexity.\footnote{See \cite{gomez2005mathematical} for the mathematical reasoning and \cite{fitch2007perception} for experimental evidence.} To assess the speed of a melody, I simply summed up the number of onsets within a measure. This has the obvious shortcoming of treating a range of different rhythms and tempi as equivalent, but should still suffice for my purpose. \textbf{\textit{\textcolor{red}{ADD EXAMPLES! (Mendelssohn Lied ohne Worte oder Hochzeitsmarsch Intro vs. vier Viertel (think of something)}}}

\subsubsection{Melodic Contour}
While concurring features may be negatively correlated, it is also quite possible that other features could conincide, such as perceptually more salient points in a melody and changes in harmony. One possible candidate for such a perceptually relevant feature is melodic contour, as explained in detail by Dowling and Harwood.\footnote{See \cite{dowling1986music}, p.133ff. for an overview. See \cite{dowling1971contour} for one of the original papers.} While their work talks about memory tasks, only that which is perceived can be memorised, making the jump to salience a small one.\footnote{See \cite{hallam2011oxford}, chapter 10 for a comprehensive overview on music and memory.} Therefore, I checked for a positive correlation of contour changes and harmony changes, resulting in a possible prediction of harmonic rhythm. a 




\chapter{The CHAMELEON harmonising system}



\chapter{Methodology (and code examples?)}


\chapter{Results}


\chapter{Discussion}



%END normal LaTex document
\newpage
\pagenumbering{roman}
\bibliographystyle{apalike}
\bibliography{mainbiblio}

\closing
\end{document}